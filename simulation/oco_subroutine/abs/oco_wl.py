import sys
import numpy as np

def oco_wv(iband, footprint=1):
    """
    Sub-program calculates OCO wavelengths
    From Pollock email April 1, 2014, need to be updated.
    
    # output
    wl: wavelength in mircon
    """
    s  = footprint    # pre-set footprint (0-7)
    n  = 1016 # pre-set number of wavelengths per channel (1...1016 consistent with L1b file)

    c  = np.arange(n)+1.   # wavelength #
    wl = np.zeros(n)       # holds wavelengths

    # Oxygen A-Band 
    # coefficients (for all 8 spectrometers/footprints)
    o2 =  [[0.75764920,   1.7491747e-05,  -2.7358146e-09,  -7.5115978e-14,   1.3216626e-16,  -7.2746905e-20],
           [0.75764505,   1.7487877e-05,  -2.7162856e-09,  -1.1507003e-13,   1.6866096e-16,  -8.4978715e-20],
           [0.75763985,   1.7501410e-05,  -2.7857486e-09,   3.3728184e-14,   2.6453049e-17,  -3.5096109e-20],
           [0.75763497,   1.7512335e-05,  -2.8476549e-09,   1.6673748e-13,  -9.8525790e-17,   7.8748270e-21],
           [0.75763166,   1.7498652e-05,  -2.7832800e-09,   2.7980819e-14,   3.5244353e-17,  -3.9636529e-20],
           [0.75762795,   1.7491036e-05,  -2.7515283e-09,  -3.6039510e-14,   9.2785422e-17,  -5.8634519e-20],
           [0.75762404,   1.7487508e-05,  -2.7449279e-09,  -3.7754169e-14,   8.0435948e-17,  -4.8428847e-20],
           [0.75761970,   1.7488254e-05,  -2.7426712e-09,  -6.1350910e-14,   1.2113713e-16,  -6.9542687e-20]]
    # Weak CO2
    # coefficients (for all 8 spectrometers/footprints)
    co2w = [[1.5905422,   3.6443391e-05,  -5.9516755e-09,   9.3932921e-13,  -9.4723993e-16,   3.1630847e-19],
            [1.5905460,   3.6435451e-05,  -5.9323636e-09,   9.2258273e-13,  -9.4880149e-16,   3.2197292e-19],
            [1.5905493,   3.6437757e-05,  -5.9672571e-09,   1.0182617e-12,  -1.0508895e-15,   3.6013836e-19],
            [1.5905525,   3.6434047e-05,  -5.9611448e-09,   1.0179609e-12,  -1.0580387e-15,   3.6409084e-19],
            [1.5905548,   3.6435218e-05,  -5.9640508e-09,   1.0172446e-12,  -1.0510189e-15,   3.5946234e-19],
            [1.5905561,   3.6446241e-05,  -6.0181002e-09,   1.1379735e-12,  -1.1728438e-15,   4.0444608e-19],
            [1.5905582,   3.6443203e-05,  -6.0011675e-09,   1.1013092e-12,  -1.1390699e-15,   3.9424472e-19],
            [1.5905584,   3.6456777e-05,  -6.0479051e-09,   1.1766416e-12,  -1.1901061e-15,   4.0387881e-19]]
    # Strong CO2
    # coefficients (for all 8 spectrometers/footprints)
    co2s = [[2.0430079,   4.6924257e-05,  -7.5338425e-09,   9.0800411e-14,   3.8512060e-16,  -1.9286362e-19],
            [2.0430259,   4.6925154e-05,  -7.5420031e-09,   1.1306612e-13,   3.5534676e-16,  -1.8192273e-19],
            [2.0430429,   4.6943726e-05,  -7.6450707e-09,   3.4315164e-13,   1.2787660e-16,  -9.9907394e-20],
            [2.0430596,   4.6953049e-05,  -7.6953095e-09,   4.5770955e-13,   1.1048747e-17,  -5.5478761e-20],
            [2.0430753,   4.6963590e-05,  -7.7202543e-09,   4.7985190e-13,   8.9334853e-18,  -5.9475311e-20],
            [2.0430897,   4.6992327e-05,  -7.8585304e-09,   7.8214971e-13,  -2.8506338e-16,   4.5177323e-20],
            [2.0431050,   4.6995609e-05,  -7.8523220e-09,   7.5326395e-13,  -2.4115874e-16,   2.3453380e-20],
            [2.0431196,   4.7010776e-05,  -7.9255174e-09,   9.3750936e-13,  -4.4263515e-16,   1.0324130e-19]]

    if iband < 0 or iband > 2:
        sys.exit('oco_wl: wrong band #')
    if iband == 0 :
        a = np.array(o2)[s, :]
    if iband == 1:
        a = np.array(co2w)[s, :]
    if iband == 2:
        a = np.array(co2s)[s, :]

    for l in range(6):
        wl = wl+a[l]*c**l

    return wl